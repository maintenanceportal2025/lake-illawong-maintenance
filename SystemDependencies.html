<!--
=====================================================================
🔗 SYSTEM DEPENDENCIES - BIDIRECTIONAL DEPENDENCY MAPPING
=====================================================================
PURPOSE: Complete dependency mapping between backends and frontends
PORTAL: SysAdmin Portal Module
VERSION: v2.0.0 - BIDIRECTIONAL MAPPING SYSTEM
LAST UPDATED: September 23, 2025
DESIGN SYSTEM: Lake Illawong Unified v1.4 - Problem Terminology Standard
- Terminology: "Problem" standard (V1.4 update)
- Header: Transparent with logo integration
- Bidirectional mapping: Backend → Frontend and Frontend → Backend
- Quick URL lookup: No more digging through Google Apps Script
- Impact analysis: Know exactly what's affected by backend changes
AUTHENTICATION: None (accessed via SysAdmin Portal)
DEPENDENCIES: Static data (no external APIs needed)
INTEGRATION FEATURES:
• Backend impact analysis (what frontends use this backend?)
• Frontend dependency mapping (what backends does this frontend need?)
• Quick URL reference (deployment URLs at a glance)
• Change impact assessment (critical path analysis)
• Copy-paste URLs for quick access
=====================================================================
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔗 System Dependencies</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(90deg, #1e40af 0%, #1e3a8a 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER - Unified Design Standard with Logo */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .logo-container {
            flex-shrink: 0;
        }

        .logo-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            padding: 5px;
           
        }

        .header-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: center;
        }

        .header-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: white;
            margin: 0 0 5px 0;
            line-height: 1.1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header-subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            margin: 0;
        }

        /* RESPONSIVE HEADER */
        @media (max-width: 480px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-text {
                align-items: center;
                text-align: center;
            }
            
            .header-title {
                font-size: 1.8rem;
            }
        }

        /* TAB NAVIGATION */
        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 30px;
        }

        .tab-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .tab-btn.active {
            background: white;
            color: #667eea;
            border-color: white;
        }

        /* MAIN CONTENT */
        .main-content {
            background: white;
            border-radius: 6px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* BACKEND CARDS */
        .backends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .backend-card {
            background: #f8fafc;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .backend-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .backend-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .backend-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .backend-info {
            flex: 1;
        }

        .backend-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .backend-description {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 10px;
        }

        .backend-url {
            font-size: 0.75rem;
            color: #667eea;
            font-family: 'Courier New', monospace;
            background: white;
            padding: 6px 10px;
            border-radius: 6px;
            word-break: break-all;
            cursor: pointer;
            transition: background 0.2s;
        }

        .backend-url:hover {
            background: #e0e7ff;
        }

        .copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s;
            margin-left: 10px;
        }

        .copy-btn:hover {
            background: #5a67d8;
        }

        .backend-stats {
            text-align: right;
            font-size: 0.85rem;
            color: #6b7280;
        }

        .frontend-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        /* FRONTEND LISTS */
        .frontends-list {
            margin-top: 15px;
        }

        .frontend-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #e5e7eb;
            transition: all 0.2s;
        }

        .frontend-item:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .frontend-name {
            font-weight: 600;
            color: #374151;
        }

        .frontend-type {
            font-size: 0.8rem;
            color: #6b7280;
            background: #f3f4f6;
            padding: 2px 8px;
            border-radius: 4px;
        }

        /* SEARCH BAR */
        .search-bar {
            margin-bottom: 25px;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* URL REFERENCE TABLE */
        .url-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .url-table th {
            background: #f8fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e5e7eb;
        }

        .url-table td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
            vertical-align: top;
        }

        .url-table tr:hover {
            background: #f0f4ff;
        }

        .url-cell {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #667eea;
            word-break: break-all;
        }

        /* UTILITY CLASSES */
        .section-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
            border-bottom: 2px solid #f3f4f6;
            padding-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-production {
            background: #d1fae5;
            color: #166534;
        }

        .status-development {
            background: #fef3c7;
            color: #92400e;
        }

        .status-deprecated {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-legacy {
            background: #e0e7ff;
            color: #3730a3;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .backends-grid {
                grid-template-columns: 1fr;
            }

            .backend-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .backend-stats {
                text-align: left;
                margin-top: 10px;
            }

            .tab-navigation {
                flex-wrap: wrap;
            }

            .tab-btn {
                flex: 1;
                min-width: 120px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="header-content">
                <div class="logo-container">
                    <img src="https://maintenanceportal2025.github.io/maintenance-portal/logo.png" alt="Lake Illawong Logo" class="logo-image">
                </div>
                <div class="header-text">
                    <h1 class="header-title">System Dependencies</h1>
                    <p class="header-subtitle">Bidirectional dependency mapping & impact analysis</p>
                </div>
            </div>
        </div>

        <!-- TAB NAVIGATION -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('backend-impact')">Backend Impact</button>
            <button class="tab-btn" onclick="switchTab('frontend-deps')">Frontend Dependencies</button>
            <button class="tab-btn" onclick="switchTab('url-reference')">URL Reference</button>
            <button class="tab-btn" onclick="switchTab('system-map')">System Map</button>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- TAB 1: Backend Impact Analysis -->
            <div id="backend-impact" class="tab-content active">
                <div class="section-title">📡 Backend Impact Analysis</div>
                <p style="color: #6b7280; margin-bottom: 25px;">Click a backend to see which frontends depend on it. Perfect for change impact assessment.</p>
                
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="🔍 Search backends..." id="backend-search">
                </div>

                <div class="backends-grid" id="backends-grid">
                    <!-- Backend cards will be generated here -->
                </div>
            </div>

            <!-- TAB 2: Frontend Dependencies -->
            <div id="frontend-deps" class="tab-content">
                <div class="section-title">🖥️ Frontend Dependencies</div>
                <p style="color: #6b7280; margin-bottom: 25px;">View what backends each frontend module depends on.</p>
                
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="🔍 Search frontends..." id="frontend-search">
                </div>

                <div class="backends-grid" id="frontends-grid">
                    <!-- Frontend cards will be generated here -->
                </div>
            </div>

            <!-- TAB 3: URL Reference -->
            <div id="url-reference" class="tab-content">
                <div class="section-title">🔗 Quick URL Reference</div>
                <p style="color: #6b7280; margin-bottom: 25px;">All backend URLs in one place. No more digging through Google Apps Script Deploy pages!</p>
                
                <table class="url-table">
                    <thead>
                        <tr>
                            <th>Backend Name</th>
                            <th>Status</th>
                            <th>Deployment URL</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="url-table-body">
                        <!-- URLs will be generated here -->
                    </tbody>
                </table>
            </div>

            <!-- TAB 4: System Architecture Map -->
            <div id="system-map" class="tab-content">
                <div class="section-title">🗺️ System Architecture Map</div>
                <p style="color: #6b7280; margin-bottom: 25px;">Visual representation of the complete system architecture and data flow.</p>
                
                <div style="background: #f8fafc; padding: 30px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">🏗️</div>
                    <h3 style="color: #374151; margin-bottom: 10px;">Architecture Visualization</h3>
                    <p style="color: #6b7280;">Interactive system map showing all connections and data flow between components.</p>
                    <p style="color: #6b7280; font-style: italic; margin-top: 15px;">[Future enhancement - Visual architecture diagram]</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =====================================================================
        // SYSTEM DEPENDENCY DATA - COMPLETE & ACCURATE
        // =====================================================================
        
        const systemData = {
            backends: [
                {
                    name: "Email Server V2.0",
                    description: "Gmail API mass notifications with server-based counting (CONSOLIDATED)",
                    url: "https://script.google.com/macros/s/AKfycbysV6QiV9-AmCjROy6dgOBxdIQLK-DW_SNrMYjJJQ2GRbqq4lHxGYEyf5_deDvZYA38/exec",
                    status: "production",
                    quota: "2000/day",
                    frontends: [
                        { name: "FieldAlerts.html V2.2", type: "Consolidated Notifications", critical: true }
                    ]
                },
                {
                    name: "MaintenancePortal V1.0",
                    description: "Problem management, assignments, and completion workflows",
                    url: "https://script.google.com/macros/s/AKfycbxtdMfxB5b1F5K401X0lJxnK2-DGkiG2zYZNukJvAHx0K1AqgPTMIdiunwS3etm0FOL/exec",
                    status: "production",
                    quota: "No limit",
                    frontends: [
                        { name: "MaintenanceModule.html", type: "Staff Interface", critical: true },
                        { name: "TimelineViewer.html", type: "Timeline View", critical: false }
                    ]
                },
                {
                    name: "ResidentSubmission Backend",
                    description: "Direct Google Sheet integration for problem submissions",
                    url: "https://script.google.com/macros/s/AKfycbwb9A9ExDlWDcT5za8Ol7CHZJhlrmvug1XLEKfCdt9sswmygo2Pnj_eSUhNy83rzI6Q/exec",
                    status: "production",
                    quota: "No limit",
                    frontends: [
                        { name: "ResidentSubmissionForm.html", type: "Problem Submission", critical: true },
                        { name: "ResidentPortal.html", type: "Portal Integration", critical: false }
                    ]
                },
                {
                    name: "Explorer V1.0",
                    description: "Read-only analytics and data exploration",
                    url: "https://script.google.com/macros/s/AKfycbzEWNgrtuamJxLUEo_dWCm9-WxoD-zDejn6LKwV3Vt8yCHv0CArlBVtzj1ad_JM0A6N/exec",
                    status: "production",
                    quota: "No limit",
                    frontends: [
                        { name: "DesktopExplorer.html", type: "Desktop Analytics", critical: false },
                        { name: "MobileExplorer.html", type: "Mobile Analytics", critical: false },
                        { name: "ResidentDirectory.html", type: "Contact Directory", critical: true },
                        { name: "ResidentHistory.html", type: "Resident Problem History", critical: true },
                        { name: "SystemHub.html", type: "Legacy System Hub", critical: false }
                    ]
                },
                {
                    name: "ManagementCentral V1.0",
                    description: "Contact management and zone representative functions",
                    url: "https://script.google.com/macros/s/AKfycbzVF25ss7kEmhE42Sf-i_vpLIL1FpTe2AjNeb0b8MqP_eBXAxV9ghWcuwe25hdEuqBFjw/exec",
                    status: "production",
                    quota: "No limit",
                    frontends: [
                        { name: "ManagementCentral.html", type: "Admin Interface", critical: true }
                    ]
                },
                {
                    name: "PasswordManager V1.0",
                    description: "Dynamic password management for all portals (replaced hardcoded passwords)",
                    url: "https://script.google.com/macros/s/AKfycbyu0RdVfmlQEnr1wi5tfkPi-tGNLzKcs5H3R9DAnKXzZROwqEPhnCvpNq3CsjKGeaxXwA/exec",
                    status: "production",
                    quota: "No limit",
                    frontends: [
                        { name: "PasswordSettings.html", type: "Admin Interface", critical: true },
                        { name: "SysAdminPortal.html", type: "Portal Login", critical: true },
                        { name: "MaintenanceModule.html", type: "Dynamic Password Auth", critical: true },
                        { name: "FieldAlerts.html V2.2", type: "Portal Authentication", critical: true },
                        { name: "FieldOperationsPortal.html", type: "Portal Login", critical: true },
                        { name: "AdminPortal.html", type: "Portal Login", critical: true },
                        { name: "ZoneRepPortal.html", type: "Portal Login", critical: true },
                        { name: "SystemDependencies.html", type: "System Module", critical: false }
                    ]
                },
                {
                    name: "Email Server V1.0 (LEGACY)",
                    description: "Legacy email system - used by deprecated MassNotifications & TemplateBuilder",
                    url: "https://script.google.com/macros/s/AKfycbxWll0dkVYKZcy5yMFvwPPVUKOuQNTb6wBF-kTjBWdVH7CJ-dc552-fBGYda7nN5LMk/exec",
                    status: "deprecated",
                    quota: "100/day",
                    frontends: [
                        { name: "MassNotifications.html (deprecated)", type: "Legacy Desktop Notifications", critical: false },
                        { name: "TemplateBuilder.html (deprecated)", type: "Legacy Template Management", critical: false }
                    ]
                }
            ],
            
            frontends: [
                {
                    name: "FieldAlerts.html V2.2",
                    description: "Consolidated notification system with dual backend integration",
                    type: "Field Operations Module",
                    status: "production",
                    backends: [
                        { name: "Email Server V2.0", purpose: "Mass notifications & server-based counting", critical: true },
                        { name: "PasswordManager V1.0", purpose: "Portal authentication", critical: true }
                    ]
                },
                {
                    name: "ResidentSubmissionForm.html",
                    description: "Resident problem reporting with direct Google Sheet integration",
                    type: "Residents Portal Module",
                    status: "production", 
                    backends: [
                        { name: "ResidentSubmission Backend", purpose: "Direct problem submission to Google Sheet", critical: true }
                    ]
                },
                {
                    name: "MaintenanceModule.html",
                    description: "Staff problem management interface with dual backend integration",
                    type: "Field Operations Module", 
                    status: "production",
                    backends: [
                        { name: "MaintenancePortal V1.0", purpose: "Problem CRUD operations", critical: true },
                        { name: "PasswordManager V1.0", purpose: "Dynamic password authentication", critical: true }
                    ]
                },
                {
                    name: "ResidentHistory.html",
                    description: "Resident problem history viewer (uses Explorer, not MaintenancePortal)",
                    type: "Residents Portal Module",
                    status: "production",
                    backends: [
                        { name: "Explorer V1.0", purpose: "Problem history data", critical: true }
                    ]
                },
                {
                    name: "TimelineViewer.html",
                    description: "Problem timeline visualization",
                    type: "Analytics Module",
                    status: "production",
                    backends: [
                        { name: "MaintenancePortal V1.0", purpose: "Timeline data", critical: true }
                    ]
                },
                {
                    name: "ResidentDirectory.html",
                    description: "Searchable contact directory",
                    type: "Multiple Portal Module",
                    status: "production",
                    backends: [
                        { name: "Explorer V1.0", purpose: "Resident data lookup", critical: true }
                    ]
                },
                {
                    name: "ManagementCentral.html",
                    description: "Contact and zone management interface",
                    type: "Admin Portal Module",
                    status: "production",
                    backends: [
                        { name: "ManagementCentral V1.0", purpose: "Contact management", critical: true }
                    ]
                },
                {
                    name: "PasswordSettings.html",
                    description: "Portal password management interface", 
                    type: "SysAdmin Portal Module",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "Password CRUD operations", critical: true }
                    ]
                },
                {
                    name: "ResidentPortal.html",
                    description: "Resident portal hub with backend integration",
                    type: "Portal Hub",
                    status: "production",
                    backends: [
                        { name: "ResidentSubmission Backend", purpose: "Portal integration", critical: false }
                    ]
                },
                {
                    name: "SystemDependencies.html",
                    description: "System dependency mapping (uses PasswordManager infrastructure)",
                    type: "SysAdmin Portal Module",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "API infrastructure reuse", critical: false }
                    ]
                },
                {
                    name: "SysAdminPortal.html",
                    description: "System administrator portal with authentication",
                    type: "Portal Hub",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "Portal login authentication", critical: true }
                    ]
                },
                {
                    name: "FieldOperationsPortal.html",
                    description: "Field operations portal with authentication",
                    type: "Portal Hub",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "Portal authentication", critical: true }
                    ]
                },
                {
                    name: "AdminPortal.html",
                    description: "Administrative portal with authentication",
                    type: "Portal Hub",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "Portal authentication", critical: true }
                    ]
                },
                {
                    name: "ZoneRepPortal.html",
                    description: "Zone representative portal with authentication only",
                    type: "Portal Hub",
                    status: "production",
                    backends: [
                        { name: "PasswordManager V1.0", purpose: "Portal authentication", critical: true }
                    ]
                },
                {
                    name: "DesktopExplorer.html",
                    description: "Desktop analytics and data exploration",
                    type: "Multiple Portal Module",
                    status: "development",
                    backends: [
                        { name: "Explorer V1.0", purpose: "Analytics data", critical: true }
                    ]
                },
                {
                    name: "MobileExplorer.html", 
                    description: "Mobile analytics interface",
                    type: "Multiple Portal Module",
                    status: "development",
                    backends: [
                        { name: "Explorer V1.0", purpose: "Analytics data", critical: true }
                    ]
                },
                {
                    name: "SystemHub.html",
                    description: "Legacy system hub with old API endpoints",
                    type: "Legacy Portal Hub",
                    status: "legacy",
                    backends: [
                        { name: "Explorer V1.0", purpose: "Explorer endpoint (current)", critical: false }
                    ]
                },
                {
                    name: "MassNotifications.html (deprecated)",
                    description: "Legacy desktop mass notifications - replaced by FieldAlerts V2.2",
                    type: "Deprecated Module",
                    status: "deprecated",
                    backends: [
                        { name: "Email Server V1.0 (LEGACY)", purpose: "Legacy email system", critical: false }
                    ]
                },
                {
                    name: "TemplateBuilder.html (deprecated)",
                    description: "Legacy template management - consolidated into FieldAlerts V2.2",
                    type: "Deprecated Module",
                    status: "deprecated",
                    backends: [
                        { name: "Email Server V1.0 (LEGACY)", purpose: "Legacy email system", critical: false }
                    ]
                }
            ]
        };

        // =====================================================================
        // UI FUNCTIONS
        // =====================================================================
        
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function renderBackendCards() {
            const container = document.getElementById('backends-grid');
            container.innerHTML = '';
            
            systemData.backends.forEach((backend, index) => {
                const criticalCount = backend.frontends.filter(f => f.critical).length;
                const totalCount = backend.frontends.length;
                
                const card = document.createElement('div');
                card.className = 'backend-card';
                card.onclick = () => toggleBackendDetails(index);
                
                card.innerHTML = `
                    <div class="backend-header">
                        <div class="backend-info">
                            <div class="backend-name">${backend.name}</div>
                            <div class="backend-description">${backend.description}</div>
                            <div class="backend-url" onclick="event.stopPropagation(); copyToClipboard('${backend.url}')">
                                ${backend.url}
                                <button class="copy-btn" onclick="event.stopPropagation(); copyToClipboard('${backend.url}')">Copy</button>
                            </div>
                        </div>
                        <div class="backend-stats">
                            <div class="frontend-count">${totalCount}</div>
                            <div>frontends</div>
                            <div style="margin-top: 5px;">
                                <span class="status-badge status-${backend.status}">${backend.status}</span>
                            </div>
                            ${criticalCount > 0 ? `<div style="color: #ef4444; font-size: 0.8rem; margin-top: 5px;">${criticalCount} critical</div>` : ''}
                        </div>
                    </div>
                    <div class="frontends-list" id="frontends-${index}" style="display: none;">
                        <div style="font-weight: 600; color: #374151; margin-bottom: 10px;">Dependent Frontends:</div>
                        ${backend.frontends.map(frontend => `
                            <div class="frontend-item ${frontend.critical ? 'critical' : ''}">
                                <div>
                                    <div class="frontend-name">${frontend.name} ${frontend.critical ? '⚠️' : ''}</div>
                                    <div style="font-size: 0.8rem; color: #6b7280;">${frontend.type}</div>
                                </div>
                                <div class="frontend-type">${frontend.critical ? 'Critical' : 'Optional'}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function renderFrontendCards() {
            const container = document.getElementById('frontends-grid');
            container.innerHTML = '';
            
            systemData.frontends.forEach((frontend, index) => {
                const criticalBackends = frontend.backends.filter(b => b.critical).length;
                
                const card = document.createElement('div');
                card.className = 'backend-card'; // Reusing same styling
                card.onclick = () => toggleFrontendDetails(index);
                
                card.innerHTML = `
                    <div class="backend-header">
                        <div class="backend-info">
                            <div class="backend-name">${frontend.name}</div>
                            <div class="backend-description">${frontend.description}</div>
                        </div>
                        <div class="backend-stats">
                            <div class="frontend-count">${frontend.backends.length}</div>
                            <div>backends</div>
                            <div style="margin-top: 5px;">
                                <span class="status-badge status-${frontend.status}">${frontend.status}</span>
                            </div>
                            ${criticalBackends > 0 ? `<div style="color: #ef4444; font-size: 0.8rem; margin-top: 5px;">${criticalBackends} critical</div>` : ''}
                        </div>
                    </div>
                    <div class="frontends-list" id="frontend-deps-${index}" style="display: none;">
                        <div style="font-weight: 600; color: #374151; margin-bottom: 10px;">Required Backends:</div>
                        ${frontend.backends.map(backend => `
                            <div class="frontend-item">
                                <div>
                                    <div class="frontend-name">${backend.name} ${backend.critical ? '⚠️' : ''}</div>
                                    <div style="font-size: 0.8rem; color: #6b7280;">${backend.purpose}</div>
                                </div>
                                <div class="frontend-type">${backend.critical ? 'Critical' : 'Optional'}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function renderUrlTable() {
            const tbody = document.getElementById('url-table-body');
            tbody.innerHTML = '';
            
            systemData.backends.forEach(backend => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="font-weight: 600;">${backend.name}</div>
                        <div style="font-size: 0.8rem; color: #6b7280;">${backend.description}</div>
                    </td>
                    <td>
                        <span class="status-badge status-${backend.status}">${backend.status}</span>
                        <div style="font-size: 0.8rem; color: #6b7280; margin-top: 4px;">Quota: ${backend.quota}</div>
                    </td>
                    <td class="url-cell">${backend.url}</td>
                    <td>
                        <button class="copy-btn" onclick="copyToClipboard('${backend.url}')">Copy URL</button>
                        <button class="copy-btn" onclick="openUrl('${backend.url}')" style="margin-left: 5px; background: #10b981;">Open</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // =====================================================================
        // INTERACTION FUNCTIONS
        // =====================================================================
        
        function toggleBackendDetails(index) {
            const details = document.getElementById(`frontends-${index}`);
            const card = details.parentNode;
            
            if (details.style.display === 'none') {
                // Hide all other details first
                document.querySelectorAll('.frontends-list').forEach(list => {
                    list.style.display = 'none';
                    list.parentNode.classList.remove('selected');
                });
                
                // Show this one
                details.style.display = 'block';
                card.classList.add('selected');
            } else {
                details.style.display = 'none';
                card.classList.remove('selected');
            }
        }

        function toggleFrontendDetails(index) {
            const details = document.getElementById(`frontend-deps-${index}`);
            const card = details.parentNode;
            
            if (details.style.display === 'none') {
                // Hide all other details first
                document.querySelectorAll('.frontends-list').forEach(list => {
                    list.style.display = 'none';
                    list.parentNode.classList.remove('selected');
                });
                
                // Show this one
                details.style.display = 'block';
                card.classList.add('selected');
            } else {
                details.style.display = 'none';
                card.classList.remove('selected');
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback
                event.target.textContent = 'Copied!';
                event.target.style.background = '#10b981';
                
                setTimeout(() => {
                    event.target.textContent = 'Copy';
                    event.target.style.background = '#667eea';
                }, 1500);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                event.target.textContent = 'Copied!';
                setTimeout(() => {
                    event.target.textContent = 'Copy';
                }, 1500);
            });
        }

        function openUrl(url) {
            if (url.includes('YOUR_')) {
                alert('⚠️ URL not configured yet!\n\nThis backend needs to be deployed and the URL updated in the SystemDependencies.html file.');
                return;
            }
            window.open(url, '_blank');
        }

        // =====================================================================
        // SEARCH FUNCTIONALITY
        // =====================================================================
        
        function setupSearch() {
            const backendSearch = document.getElementById('backend-search');
            const frontendSearch = document.getElementById('frontend-search');
            
            backendSearch.addEventListener('input', (e) => {
                filterBackends(e.target.value.toLowerCase());
            });
            
            frontendSearch.addEventListener('input', (e) => {
                filterFrontends(e.target.value.toLowerCase());
            });
        }

        function filterBackends(searchTerm) {
            const cards = document.querySelectorAll('#backends-grid .backend-card');
            
            cards.forEach(card => {
                const name = card.querySelector('.backend-name').textContent.toLowerCase();
                const description = card.querySelector('.backend-description').textContent.toLowerCase();
                
                if (name.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterFrontends(searchTerm) {
            const cards = document.querySelectorAll('#frontends-grid .backend-card');
            
            cards.forEach(card => {
                const name = card.querySelector('.backend-name').textContent.toLowerCase();
                const description = card.querySelector('.backend-description').textContent.toLowerCase();
                
                if (name.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // =====================================================================
        // INITIALIZATION
        // =====================================================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🔗 System Dependencies V2.0 - Bidirectional Mapping System');
            
            // Render all components
            renderBackendCards();
            renderFrontendCards(); 
            renderUrlTable();
            
            // Setup search functionality
            setupSearch();
            
            console.log('✅ System Dependencies initialized');
            console.log(`📊 Loaded ${systemData.backends.length} backends and ${systemData.frontends.length} frontends`);
        });

        // =====================================================================
        // UTILITY FUNCTIONS
        // =====================================================================
        
        function exportDependencyData() {
            const dataStr = JSON.stringify(systemData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'system-dependencies.json';
            link.click();
            
            URL.revokeObjectURL(url);
        }

        function printDependencies() {
            window.print();
        }

        // Add export functionality
        window.exportDependencyData = exportDependencyData;
        window.printDependencies = printDependencies;
        
        // Error handling
        window.addEventListener('error', function(e) {
            console.error('❌ System Dependencies error:', e.error);
        });
        
        // Performance monitoring
        window.addEventListener('load', function() {
            const loadTime = (performance.now() / 1000).toFixed(2);
            console.log(`⚡ System Dependencies loaded in ${loadTime} seconds`);
        });
    </script>
</body>
</html>
